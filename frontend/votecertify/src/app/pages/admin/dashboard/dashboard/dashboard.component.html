<div class="dashboard-container">
  <!-- Welcome section with Analytics card -->
  <div class="welcome-section">
    <!-- Welcome card -->
    <div class="welcome-card">
      <div class="icon-area">
        <i class="fa-solid fa-user-shield"></i>
      </div>
      <div class="welcome-content">
        <h1>Welcome, Admin!</h1>
        <p>
          This is your control panel for managing the VoteCertify system. Oversee certificate requests, manage COMELEC staff accounts, and monitor system metrics with ease.
        </p>
        <div class="admin-badge">
          <span class="badge-icon">ðŸ‘‘</span>
          <span>Administrator Access</span>
        </div>
      </div>
    </div>

    <!-- Web App Visits Card - Right Side -->
    <div class="card analytics" *ngIf="analytics$ | async as analytics">
      <div class="analytics-header">
        <div class="icon"><i class="fas fa-chart-line"></i></div>
        <h3>Total Website Views</h3>
      </div>
      
      <div class="analytics-stats">
        <div class="stat-item">
          <span class="stat-label">Total Views</span>
          <span class="stat-value">{{ analytics.totalVisits | number }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Unique Visitors</span>
          <span class="stat-value">{{ analytics.uniqueUsers | number }}</span>
        </div>
      </div>

      <div class="trend-indicator">
        <span class="trend-label">Last 7 Days</span>
        <div class="mini-chart">
          <div class="bar-container" *ngFor="let day of analytics.weeklyTrend">
            <div 
              class="bar" 
              [style.height]="getBarHeight(day.visits) + '%'"
              [title]="day.date + ': ' + day.visits + ' visits'"
            ></div>
          </div>
        </div>
      </div>

      <div class="refresh-hint">
        <i class="fas fa-sync-alt"></i>
        <span>Updates in real-time</span>
      </div>
    </div>
  </div>

  <!-- Statistic cards -->
  <div class="dashboard-cards">
    <div class="card staff">
      <div class="icon"><i class="fas fa-users"></i></div>
      <h3>Number Of COMELEC Staff</h3>
      <p>{{ totalStaff }}</p>
    </div>

    <div class="card processed">
      <div class="icon"><i class="fas fa-clipboard-check"></i></div>
      <h3>Processed Voter Certificates</h3>
      <p>{{ totalProcessed }}</p>
    </div>

    <div class="card today">
      <div class="icon"><i class="fas fa-calendar-day"></i></div>
      <h3>Today's Requests</h3>
      <p>{{ todaysRequests }}</p>
    </div>

    <div class="card voters">
      <div class="icon"><i class="fas fa-user-plus"></i></div>
      <h3>User Registrations (Voters)</h3>
      <p>{{ totalVoterAccounts }}</p>
    </div>
  </div>

  <!-- Analytics controls -->
  <div class="analytics-controls">
    <div class="controls-left">
      <label for="rangeSelect">Analytics Range</label>
      <select id="rangeSelect" [(ngModel)]="selectedRange" (change)="onRangeChange()">
        <option value="thisMonth">This Month</option>
        <option value="thisWeek">This Week</option>
        <option value="thisYear">This Year</option>
      </select>
    </div>

    <div class="controls-middle">
      <label for="monthSelect">Select Month for Report</label>
      <select id="monthSelect" [(ngModel)]="selectedMonthYear" (change)="onMonthChange()">
        <option *ngFor="let month of availableMonths" [value]="month.value">
          {{ month.label }}
        </option>
      </select>
    </div>

    <button class="btn-download" (click)="downloadReport()">Download Report (PDF)</button>
  </div>

  <!-- Chart -->
  <div class="chart-container">
    <h2>{{ chartTitle }}</h2>
    <div class="chart-wrapper">
      <canvas id="requestsChart"></canvas>
    </div>

    <div class="analytics-summary">
      <div class="summary-item"><strong>Total:</strong> {{ analyticsTotals.total }}</div>
      <div class="summary-item"><strong>Approved:</strong> {{ analyticsTotals.approved }}</div>
      <div class="summary-item"><strong>Pending:</strong> {{ analyticsTotals.pending }}</div>
      <div class="summary-item"><strong>Declined:</strong> {{ analyticsTotals.declined }}</div>
    </div>
  </div>
</div>
