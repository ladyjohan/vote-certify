<div class="dashboard-wrapper">
  <header class="dashboard-header">
    <h1 style="margin-bottom: 0;">Welcome, {{ displayName || 'Voter' }}! <span aria-label="wave" title="wave">ðŸ‘‹</span></h1>
    <p style="margin-top: 0.2em;">
      This is your personal dashboard for requesting and tracking your voter's certificate. Easily start a new request, monitor your status, and stay updated every step of the way.
    </p>
  </header>

  <main class="dashboard-main dashboard-row">
  <div class="dashboard-row-card dashboard-card status-card dashboard-content-padding">
      <h2>Status</h2>
      <p>Your latest request status:</p>
      <ng-container *ngIf="currentRequest; else noRequest">
        <div class="status-card-inner" [ngClass]="{
          'pending': currentRequest.status === 'Pending',
          'approved': currentRequest.status === 'Approved',
          'completed': currentRequest.status === 'Completed',
          'declined': currentRequest.status === 'Declined'
        }">
          <p><strong>Precinct Number:</strong> {{ currentRequest.voterId }}</p>
          <p><strong>Full Name:</strong> {{ currentRequest.fullName }}</p>
          <p><strong>Birthdate:</strong> {{ currentRequest.birthdate }}</p>
          <p><strong>Purpose:</strong> {{ currentRequest.purpose }}</p>
          <p><strong>Copies Requested:</strong> {{ currentRequest.copiesRequested }}</p>
          <p><strong>Status: </strong>
            <span [ngClass]="{
              'text-yellow-500': currentRequest.status === 'Pending',
              'text-green-600': currentRequest.status === 'Approved' || currentRequest.status === 'Ready for Pickup',
              'text-red-600': currentRequest.status === 'Declined',
              'text-grey-600': currentRequest.status === 'Completed'
            }">{{ currentRequest.status }}</span>
          </p>
          <p><strong>Submitted At:</strong> {{ currentRequest.submittedAt ? (currentRequest.submittedAt.toDate() | date:'medium') : 'N/A' }}</p>

          <ng-container *ngIf="currentRequest.status === 'Approved' || currentRequest.status === 'Ready for Pickup'">
            <p><strong>Pick-up Date:</strong> {{ currentRequest.pickupDate || 'To be scheduled' }}</p>
          </ng-container>

          <ng-container *ngIf="currentRequest.status === 'Declined'">
            <p><strong>Remarks:</strong> {{ currentRequest.remarks || 'No remarks provided.' }}</p>
          </ng-container>
        </div>
      </ng-container>
      <ng-template #noRequest>
        <div class="status-value">No requests found</div>
      </ng-template>
      <div class="status-actions-row">
        <button routerLink="/voter/certificate-status">View Certificate History</button>
        <button
          routerLink="/voter/request-form"
          [disabled]="currentRequest && currentRequest.status === 'Pending'"
          [ngClass]="{'disabled-btn': currentRequest && currentRequest.status === 'Pending'}"
        >Request New Certificate</button>
      </div>
      <div *ngIf="currentRequest && currentRequest.status === 'Pending'" class="pending-msg">
       *You can't request a new one because your request is still <b class="pending-orange">Pending</b>. Please wait until it is Approved or Declined.*
      </div>
    </div>
  <div class="dashboard-row-card dashboard-info dashboard-content-padding">
      <h2>How to Use the Dashboard</h2>
      <ul>
        <li>Start a new request for a voterâ€™s certificate.</li>
        <li>Track the progress and status of your requests.</li>
        <li>Get notified when your certificate is ready for pickup.</li>
      </ul>
    </div>
  </main>
</div>
